<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Anki Dashboard</title>
    <link rel="stylesheet" href="/static/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <!-- Ionicons for beautiful icons -->
    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
    ></script>
  </head>
  <body>
    <!-- Subtle Background (Minimal) -->
    <div class="app-background"></div>

    <div class="app-container">
      <!-- SIDEBAR -->
      <div class="sidebar">
        <div class="brand">
          <ion-icon name="flash"></ion-icon>
          <span>AnkiFlow</span>
        </div>

        <div class="sidebar-section">
          <h3>My Decks</h3>
          <ul class="deck-list" id="deckList">
            <!-- Decks injected here -->
          </ul>
          <button class="new-deck-btn" id="btnNewDeck">
            <ion-icon name="add-circle"></ion-icon> New Deck
          </button>
        </div>

        <div class="sidebar-footer">
          <div class="status-indicator online">
            <span class="dot"></span> System Ready
          </div>
        </div>
      </div>

      <!-- MAIN WORKSPACE -->
      <div class="main-content">
        <!-- TOP BAR (Omnibar) -->
        <div class="top-bar">
          <div class="omnibar-container" id="omnibarContainer">
              <div class="omnibar-icon clickable" id="omnibarIcon" title="Click to upload file">
                <ion-icon name="cloud-upload-outline"></ion-icon>
              </div>
            <input
              type="text"
              id="omnibarInput"
              placeholder="Type word - def, paste text, or drag files here..."
              autocomplete="off"
            />
            <div class="omnibar-actions">
              <span class="key-hint">ENTER</span>
            </div>
            <!-- Hidden File Input for Drag & Drop / Click -->
            <input
              type="file"
              id="fileInput"
              class="hidden"
              accept=".txt,.csv,.docx"
            />
            <!-- Command Palette Dropdown -->
            <div id="commandDropdown" class="command-dropdown hidden"></div>
          </div>
        </div>

        <!-- WORKSPACE AREA -->
        <div class="workspace">
          <div class="deck-header">
            <h1 id="currentDeckTitle">My Vocabulary</h1>
            
            <!-- Search Input -->
            <div class="search-container">
              <ion-icon name="search-outline" class="search-icon"></ion-icon>
              <input 
                type="text" 
                id="searchInput" 
                placeholder="Search cards..." 
                autocomplete="off"
              />
              <button class="search-clear hidden" id="btnClearSearch">
                <ion-icon name="close-outline"></ion-icon>
              </button>
            </div>
            
            <div class="deck-stats">
              <span class="stat-badge"
                ><span id="countTotal">0</span> Items</span
              >
              <span class="stat-badge warning hidden" id="countIssues"
                >0 Issues</span
              >
            </div>
          </div>

          <div class="table-container">
            <table class="live-table" id="cardTable">
              <thead>
                <tr>
                  <th>Term</th>
                  <th>Definition</th>
                  <th>Tags</th>
                  <th style="width: 50px"></th>
                </tr>
              </thead>
              <tbody id="tableBody">
                <!-- Rows injected here -->
                <!-- Empty State -->
                <tr class="empty-state" id="emptyState">
                  <td colspan="3">
                    <div class="empty-content">
                      <ion-icon name="library-outline"></ion-icon>
                      <p>Start typing or drag a file to begin.</p>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ACTION BAR -->
        <div class="action-bar">
          <button class="action-btn secondary" id="btnClearDeck">
            <ion-icon name="trash-outline"></ion-icon> Clear
          </button>
          <button class="action-btn primary" id="btnExportAnki">
            <ion-icon name="download-outline"></ion-icon> Export to Anki
          </button>
        </div>
      </div>
    </div>

    <!-- TOAST NOTIFICATION -->
    <div id="toast" class="toast hidden">Action Successful</div>

    <!-- EXPORT MODAL (Hidden by default) -->
    <div id="exportModal" class="modal-overlay hidden">
        <div class="modal-glass">
            <h2>Export Deck</h2>
            <div class="form-group">
                <label>Filename</label>
                <input type="text" id="exportFilename" value="my_deck" />
            </div>
            
            <div class="form-group">
                <label>Format</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="exportFormat" value="apkg" checked>
                        <span>Anki Package (.apkg)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="exportFormat" value="txt">
                        <span>Text File (.txt)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="exportFormat" value="md">
                        <span>Markdown (.md)</span>
                    </label>
                </div>
            </div>

            <div class="modal-actions">
                <button class="action-btn secondary" id="btnCancelExport">
                    Cancel
                </button>
                <button class="action-btn primary" id="btnConfirmExport">
                    Download .apkg
                </button>
            </div>
            <div id="exportLoader" class="loader-line hidden"></div>
        </div>
    </div>

    <!-- KEYBOARD SHORTCUTS MODAL -->
    <div id="shortcutsModal" class="modal-overlay hidden">
      <div class="modal-glass">
        <h2>Keyboard Shortcuts</h2>
        <div class="shortcuts-table">
          <div class="shortcuts-section">
            <h3>Navigation</h3>
            <div class="shortcut-row">
              <span class="shortcut-keys"><kbd>F1</kbd></span>
              <span class="shortcut-desc">Open command palette</span>
            </div>
            <div class="shortcut-row">
              <span class="shortcut-keys"><kbd>Esc</kbd></span>
              <span class="shortcut-desc">Close modals / Clear command palette</span>
            </div>
          </div>
          
          <div class="shortcuts-section">
            <h3>Editing</h3>
            <div class="shortcut-row">
              <span class="shortcut-keys"><kbd>Enter</kbd></span>
              <span class="shortcut-desc">Add card from omnibar</span>
            </div>
            <div class="shortcut-row">
              <span class="shortcut-keys"><kbd>Ctrl</kbd> + <kbd>Z</kbd></span>
              <span class="shortcut-desc">Undo last action</span>
            </div>
            <div class="shortcut-row">
              <span class="shortcut-keys"><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Z</kbd></span>
              <span class="shortcut-desc">Redo action</span>
            </div>
          </div>
          
          <div class="shortcuts-section">
            <h3>Help</h3>
            <div class="shortcut-row">
              <span class="shortcut-keys"><kbd>Ctrl</kbd> + <kbd>/</kbd></span>
              <span class="shortcut-desc">Show this help panel</span>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button class="action-btn primary" id="btnCloseShortcuts">Close</button>
        </div>
      </div>
    </div>

    <!-- GENERIC CUSTOM MODAL -->
    <div id="customModal" class="modal-overlay hidden">
      <div class="modal-glass">
        <h2 id="customModalTitle">Title</h2>
        <div id="customModalContent" class="modal-content"></div>
        <div class="form-group hidden" id="customModalInputContainer">
            <input type="text" id="customModalInput" class="modal-input" autocomplete="off">
        </div>
        <div class="modal-actions">
          <button class="action-btn secondary" id="btnModalCancel">Cancel</button>
          <button class="action-btn primary" id="btnModalConfirm">Confirm</button>
        </div>
      </div>
    </div>

    <script src="/static/script.js"></script>
  </body>
</html>
